/** @license canvg.js | Copyright (c) 2010-2011 Gabe Lerner <gabelerner@gmail.com> [https://github.com/canvg/canvg] | MIT License [https://github.com/canvg/canvg/blob/master/MIT-LICENSE.txt] */
(function(){this.canvg=function(c,e,f){if(c==null&&e==null&&f==null){var h=document.querySelectorAll('svg');for(var k=0;k<h.length;k++){var j=h[k],l=document.createElement('canvas');l.width=j.clientWidth;l.height=j.clientHeight;j.parentNode.insertBefore(l,j);j.parentNode.removeChild(j);var q=document.createElement('div');q.appendChild(j);canvg(l,q.innerHTML);}return ;}if(typeof c=='string'){c=document.getElementById(c);}if(c.svg!=null)c.svg.stop();var n=W(f||{});if(!(c.childNodes.length==1&&c.childNodes[0].nodeName=='OBJECT'))c.svg=n;var u=c.getContext('2d');if(typeof (e.documentElement)!='undefined'){n.loadXmlDoc(u,e);}else if(e.substr(0,1)=='<'){n.loadXml(u,e);}else{n.load(u,e);}};function W(V){var d={opts:V};d.FRAMERATE=30;d.MAX_VIRTUAL_PIXELS=30000;d.log=function(c){};if(d.opts['log']==true&&typeof (console)!='undefined'){d.log=function(c){console.log(c);};};d.init=function(f){var h=0;d.UniqueId=function(){h++;return 'canvg'+h;};d.Definitions={};d.Styles={};d.Animations=[];d.Images=[];d.ctx=f;d.ViewPort=new (function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[];};this.SetCurrent=function(c,e){this.viewPorts.push({width:c,height:e});};this.RemoveCurrent=function(){this.viewPorts.pop();};this.Current=function(){return this.viewPorts[this.viewPorts.length-1];};this.width=function(){return this.Current().width;};this.height=function(){return this.Current().height;};this.ComputeSize=function(c){if(c!=null&&typeof (c)=='number')return c;if(c=='x')return this.width();if(c=='y')return this.height();return Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2);};});};d.init();d.ImagesLoaded=function(){for(var c=0;c<d.Images.length;c++){if(!d.Images[c].loaded)return false;}return true;};d.trim=function(c){return c.replace(/^\s+|\s+$/g,'');};d.compressSpaces=function(c){return c.replace(/[\s\r\t\n]+/gm,' ');};d.ajax=function(c){var e;if(window.XMLHttpRequest){e=new XMLHttpRequest();}else{e=new ActiveXObject('Microsoft.XMLHTTP');}if(e){e.open('GET',c,false);e.send(null);return e.responseText;}return null;};d.parseXml=function(c){if(window.DOMParser){var e=new DOMParser();return e.parseFromString(c,'text/xml');}else{c=c.replace(/<!DOCTYPE svg[^>]*>/,'');var f=new ActiveXObject('Microsoft.XMLDOM');f.async='false';f.loadXML(c);return f;}};d.Property=function(c,e){this.name=c;this.value=e;};d.Property.prototype.getValue=function(){return this.value;};d.Property.prototype.hasValue=function(){return (this.value!=null&&this.value!=='');};d.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var c=parseFloat(this.value);if((this.value+'').match(/%$/)){c=c/100.0;}return c;};d.Property.prototype.valueOrDefault=function(c){if(this.hasValue())return this.value;return c;};d.Property.prototype.numValueOrDefault=function(c){if(this.hasValue())return this.numValue();return c;};d.Property.prototype.addOpacity=function(c){var e=this.value;if(c!=null&&c!=''&&typeof (this.value)=='string'){var f=new RGBColor(this.value);if(f.ok){e='rgba('+f.r+', '+f.g+', '+f.b+', '+c+')';}}return new d.Property(this.name,e);};d.Property.prototype.getDefinition=function(){var c=this.value.match(/#([^\)'"]+)/);if(c){c=c[1];}if(!c){c=this.value;}return d.Definitions[c];};d.Property.prototype.isUrlDefinition=function(){return this.value.indexOf('url(')==0;};d.Property.prototype.getFillStyleDefinition=function(c,e){var f=this.getDefinition();if(f!=null&&f.createGradient){return f.createGradient(d.ctx,c,e);}if(f!=null&&f.createPattern){if(f.getHrefAttribute().hasValue()){var h=f.attribute('patternTransform');f=f.getHrefAttribute().getDefinition();if(h.hasValue()){f.attribute('patternTransform',true).value=h.value;}}return f.createPattern(d.ctx,c);}return null;};d.Property.prototype.getDPI=function(c){return 96.0;};d.Property.prototype.getEM=function(c){var e=12,f=new d.Property('fontSize',d.Font.Parse(d.ctx.font).fontSize);if(f.hasValue())e=f.toPixels(c);return e;};d.Property.prototype.getUnits=function(){var c=this.value+'';return c.replace(/[0-9\.\-]/g,'');};d.Property.prototype.toPixels=function(c,e){if(!this.hasValue())return 0;var f=this.value+'';if(f.match(/em$/))return this.numValue()*this.getEM(c);if(f.match(/ex$/))return this.numValue()*this.getEM(c)/2.0;if(f.match(/px$/))return this.numValue();if(f.match(/pt$/))return this.numValue()*this.getDPI(c)*(1.0/72.0);if(f.match(/pc$/))return this.numValue()*15;if(f.match(/cm$/))return this.numValue()*this.getDPI(c)/2.54;if(f.match(/mm$/))return this.numValue()*this.getDPI(c)/25.4;if(f.match(/in$/))return this.numValue()*this.getDPI(c);if(f.match(/%$/))return this.numValue()*d.ViewPort.ComputeSize(c);var h=this.numValue();if(e&&h<1.0)return h*d.ViewPort.ComputeSize(c);return h;};d.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var c=this.value+'';if(c.match(/s$/))return this.numValue()*1000;if(c.match(/ms$/))return this.numValue();return this.numValue();};d.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var c=this.value+'';if(c.match(/deg$/))return this.numValue()*(Math.PI/180.0);if(c.match(/grad$/))return this.numValue()*(Math.PI/200.0);if(c.match(/rad$/))return this.numValue();return this.numValue()*(Math.PI/180.0);};var U={'baseline':'alphabetic','before-edge':'top','text-before-edge':'top','middle':'middle','central':'middle','after-edge':'bottom','text-after-edge':'bottom','ideographic':'ideographic','alphabetic':'alphabetic','hanging':'hanging','mathematical':'alphabetic'};d.Property.prototype.toTextBaseline=function(){if(!this.hasValue())return null;return U[this.value];};d.Font=new (function(){this.Styles='normal|italic|oblique|inherit';this.Variants='normal|small-caps|inherit';this.Weights='normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit';this.CreateFont=function(c,e,f,h,k,j){var l=j!=null?this.Parse(j):this.CreateFont('','','','','',d.ctx.font);return {fontFamily:k||l.fontFamily,fontSize:h||l.fontSize,fontStyle:c||l.fontStyle,fontWeight:f||l.fontWeight,fontVariant:e||l.fontVariant,toString:function(){return [this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(' ');}};};var q=this;this.Parse=function(c){var e={},f=d.trim(d.compressSpaces(c||'')).split(' '),h={fontSize:false,fontStyle:false,fontWeight:false,fontVariant:false},k='';for(var j=0;j<f.length;j++){if(!h.fontStyle&&q.Styles.indexOf(f[j])!=-1){if(f[j]!='inherit')e.fontStyle=f[j];h.fontStyle=true;}else if(!h.fontVariant&&q.Variants.indexOf(f[j])!=-1){if(f[j]!='inherit')e.fontVariant=f[j];h.fontStyle=h.fontVariant=true;}else if(!h.fontWeight&&q.Weights.indexOf(f[j])!=-1){if(f[j]!='inherit')e.fontWeight=f[j];h.fontStyle=h.fontVariant=h.fontWeight=true;}else if(!h.fontSize){if(f[j]!='inherit')e.fontSize=f[j].split('/')[0];h.fontStyle=h.fontVariant=h.fontWeight=h.fontSize=true;}else{if(f[j]!='inherit')k+=f[j];}}if(k!='')e.fontFamily=k;return e;};});d.ToNumberArray=function(c){var e=d.trim(d.compressSpaces((c||'').replace(/,/g,' '))).split(' ');for(var f=0;f<e.length;f++){e[f]=parseFloat(e[f]);}return e;};d.Point=function(c,e){this.x=c;this.y=e;};d.Point.prototype.angleTo=function(c){return Math.atan2(c.y-this.y,c.x-this.x);};d.Point.prototype.applyTransform=function(c){var e=this.x*c[0]+this.y*c[2]+c[4],f=this.x*c[1]+this.y*c[3]+c[5];this.x=e;this.y=f;};d.CreatePoint=function(c){var e=d.ToNumberArray(c);return new d.Point(e[0],e[1]);};d.CreatePath=function(c){var e=d.ToNumberArray(c),f=[];for(var h=0;h<e.length;h+=2){f.push(new d.Point(e[h],e[h+1]));}return f;};d.BoundingBox=function(F,I,H,J){this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN;this.x=function(){return this.x1;};this.y=function(){return this.y1;};this.width=function(){return this.x2-this.x1;};this.height=function(){return this.y2-this.y1;};this.addPoint=function(c,e){if(c!=null){if(isNaN(this.x1)||isNaN(this.x2)){this.x1=c;this.x2=c;}if(c<this.x1)this.x1=c;if(c>this.x2)this.x2=c;}if(e!=null){if(isNaN(this.y1)||isNaN(this.y2)){this.y1=e;this.y2=e;}if(e<this.y1)this.y1=e;if(e>this.y2)this.y2=e;}};this.addX=function(c){this.addPoint(c,null);};this.addY=function(c){this.addPoint(null,c);};this.addBoundingBox=function(c){this.addPoint(c.x1,c.y1);this.addPoint(c.x2,c.y2);};this.addQuadraticCurve=function(c,e,f,h,k,j){var l=c+2/3*(f-c),q=e+2/3*(h-e),n=l+1/3*(k-c),u=q+1/3*(j-e);this.addBezierCurve(c,e,l,n,q,u,k,j);};this.addBezierCurve=function(e,f,h,k,j,l,q,n){var u=[e,f],s=[h,k],o=[j,l],t=[q,n];this.addPoint(u[0],u[1]);this.addPoint(t[0],t[1]);for(i=0;i<=1;i++){var v=function(c){return Math.pow(1-c,3)*u[i]+3*Math.pow(1-c,2)*c*s[i]+3*(1-c)*Math.pow(c,2)*o[i]+Math.pow(c,3)*t[i];},w=6*u[i]-12*s[i]+6*o[i],A=-3*u[i]+9*s[i]-9*o[i]+3*t[i],B=3*s[i]-3*u[i];if(A==0){if(w==0)continue;var z=-B/w;if(0<z&&z<1){if(i==0)this.addX(v(z));if(i==1)this.addY(v(z));}continue;}var G=Math.pow(w,2)-4*B*A;if(G<0)continue;var E=(-w+Math.sqrt(G))/(2*A);if(0<E&&E<1){if(i==0)this.addX(v(E));if(i==1)this.addY(v(E));}var D=(-w-Math.sqrt(G))/(2*A);if(0<D&&D<1){if(i==0)this.addX(v(D));if(i==1)this.addY(v(D));}}};this.isPointInBox=function(c,e){return (this.x1<=c&&c<=this.x2&&this.y1<=e&&e<=this.y2);};this.addPoint(F,I);this.addPoint(H,J);};d.Transform=function(k){var j=this;this.Type={};this.Type.translate=function(e){this.p=d.CreatePoint(e);this.apply=function(c){c.translate(this.p.x||0.0,this.p.y||0.0);};this.unapply=function(c){c.translate(-1.0*this.p.x||0.0,-1.0*this.p.y||0.0);};this.applyToPoint=function(c){c.applyTransform([1,0,0,1,this.p.x||0.0,this.p.y||0.0]);};};this.Type.rotate=function(f){var h=d.ToNumberArray(f);this.angle=new d.Property('angle',h[0]);this.cx=h[1]||0;this.cy=h[2]||0;this.apply=function(c){c.translate(this.cx,this.cy);c.rotate(this.angle.toRadians());c.translate(-this.cx,-this.cy);};this.unapply=function(c){c.translate(this.cx,this.cy);c.rotate(-1.0*this.angle.toRadians());c.translate(-this.cx,-this.cy);};this.applyToPoint=function(c){var e=this.angle.toRadians();c.applyTransform([1,0,0,1,this.p.x||0.0,this.p.y||0.0]);c.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]);c.applyTransform([1,0,0,1,-this.p.x||0.0,-this.p.y||0.0]);};};this.Type.scale=function(e){this.p=d.CreatePoint(e);this.apply=function(c){c.scale(this.p.x||1.0,this.p.y||this.p.x||1.0);};this.unapply=function(c){c.scale(1.0/this.p.x||1.0,1.0/this.p.y||this.p.x||1.0);};this.applyToPoint=function(c){c.applyTransform([this.p.x||0.0,0,0,this.p.y||0.0,0,0]);};};this.Type.matrix=function(e){this.m=d.ToNumberArray(e);this.apply=function(c){c.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5]);};this.applyToPoint=function(c){c.applyTransform(this.m);};};this.Type.SkewBase=function(c){this.base=j.Type.matrix;this.base(c);this.angle=new d.Property('angle',c);};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(c){this.base=j.Type.SkewBase;this.base(c);this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0];};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(c){this.base=j.Type.SkewBase;this.base(c);this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0];};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(c){for(var e=0;e<this.transforms.length;e++){this.transforms[e].apply(c);}};this.unapply=function(c){for(var e=this.transforms.length-1;e>=0;e--){this.transforms[e].unapply(c);}};this.applyToPoint=function(c){for(var e=0;e<this.transforms.length;e++){this.transforms[e].applyToPoint(c);}};var l=d.trim(d.compressSpaces(k)).replace(/\)(\s?,\s?)/g,') ').split(/\s(?=[a-z])/);for(var q=0;q<l.length;q++){var n=d.trim(l[q].split('(')[0]),u=l[q].split('(')[1].replace(')',''),s=new this.Type[n](u);s.type=n;this.transforms.push(s);}};d.AspectRatio=function(c,e,f,h,k,j,l,q,n,u){e=d.compressSpaces(e);e=e.replace(/^defer\s/,'');var s=e.split(' ')[0]||'xMidYMid',o=e.split(' ')[1]||'meet',t=f/h,v=k/j,w=Math.min(t,v),A=Math.max(t,v);if(o=='meet'){h*=w;j*=w;}if(o=='slice'){h*=A;j*=A;}n=new d.Property('refX',n);u=new d.Property('refY',u);if(n.hasValue()&&u.hasValue()){c.translate(-w*n.toPixels('x'),-w*u.toPixels('y'));}else{if(s.match(/^xMid/)&&((o=='meet'&&w==v)||(o=='slice'&&A==v)))c.translate(f/2.0-h/2.0,0);if(s.match(/YMid$/)&&((o=='meet'&&w==t)||(o=='slice'&&A==t)))c.translate(0,k/2.0-j/2.0);if(s.match(/^xMax/)&&((o=='meet'&&w==v)||(o=='slice'&&A==v)))c.translate(f-h,0);if(s.match(/YMax$/)&&((o=='meet'&&w==t)||(o=='slice'&&A==t)))c.translate(0,k-j);}if(s=='none')c.scale(t,v);else if(o=='meet')c.scale(w,w);else if(o=='slice')c.scale(A,A);c.translate(l==null?0:-l,q==null?0:-q);};d.Element={};d.EmptyProperty=new d.Property('EMPTY','');d.Element.ElementBase=function(l){this.attributes={};this.styles={};this.children=[];this.attribute=function(c,e){var f=this.attributes[c];if(f!=null)return f;if(e==true){f=new d.Property(c,'');this.attributes[c]=f;}return f||d.EmptyProperty;};this.getHrefAttribute=function(){for(var c in this.attributes){if(c.match(/:href$/)){return this.attributes[c];}}return d.EmptyProperty;};this.style=function(c,e){var f=this.styles[c];if(f!=null)return f;var h=this.attribute(c);if(h!=null&&h.hasValue()){this.styles[c]=h;return h;}var k=this.parent;if(k!=null){var j=k.style(c);if(j!=null&&j.hasValue()){return j;}}if(e==true){f=new d.Property(c,'');this.styles[c]=f;}return f||d.EmptyProperty;};this.render=function(c){if(this.style('display').value=='none')return ;if(this.style('visibility').value=='hidden')return ;c.save();if(this.attribute('mask').hasValue()){var e=this.attribute('mask').getDefinition();if(e!=null)e.apply(c,this);}else if(this.style('filter').hasValue()){var f=this.style('filter').getDefinition();if(f!=null)f.apply(c,this);}else{this.setContext(c);this.renderChildren(c);this.clearContext(c);}c.restore();};this.setContext=function(c){};this.clearContext=function(c){};this.renderChildren=function(c){for(var e=0;e<this.children.length;e++){this.children[e].render(c);}};this.addChild=function(c,e){var f=c;if(e)f=d.CreateElement(c);f.parent=this;this.children.push(f);};if(l!=null&&l.nodeType==1){for(var q=0;q<l.childNodes.length;q++){var n=l.childNodes[q];if(n.nodeType==1)this.addChild(n,true);if(this.captureTextNodes&&n.nodeType==3){var u=n.nodeValue||n.text||'';if(d.trim(d.compressSpaces(u))!=''){this.addChild(new d.Element.tspan(n),false);}}}for(var q=0;q<l.attributes.length;q++){var s=l.attributes[q];this.attributes[s.nodeName]=new d.Property(s.nodeName,s.nodeValue);}var o=d.Styles[l.nodeName];if(o!=null){for(var t in o){this.styles[t]=o[t];}}if(this.attribute('class').hasValue()){var v=d.compressSpaces(this.attribute('class').value).split(' ');for(var w=0;w<v.length;w++){o=d.Styles['.'+v[w]];if(o!=null){for(var t in o){this.styles[t]=o[t];}}o=d.Styles[l.nodeName+'.'+v[w]];if(o!=null){for(var t in o){this.styles[t]=o[t];}}}}if(this.attribute('id').hasValue()){var o=d.Styles['#'+this.attribute('id').value];if(o!=null){for(var t in o){this.styles[t]=o[t];}}}if(this.attribute('style').hasValue()){var o=this.attribute('style').value.split(';');for(var q=0;q<o.length;q++){if(d.trim(o[q])!=''){var A=o[q].split(':'),t=d.trim(A[0]),B=d.trim(A[1]);this.styles[t]=new d.Property(t,B);}}}if(this.attribute('id').hasValue()){if(d.Definitions[this.attribute('id').value]==null){d.Definitions[this.attribute('id').value]=this;}}}};d.Element.RenderedElementBase=function(u){this.base=d.Element.ElementBase;this.base(u);this.setContext=function(c){if(this.style('fill').isUrlDefinition()){var e=this.style('fill').getFillStyleDefinition(this,this.style('fill-opacity'));if(e!=null)c.fillStyle=e;}else if(this.style('fill').hasValue()){var f=this.style('fill');if(f.value=='currentColor')f.value=this.style('color').value;c.fillStyle=(f.value=='none'?'rgba(0,0,0,0)':f.value);}if(this.style('fill-opacity').hasValue()){var f=new d.Property('fill',c.fillStyle);f=f.addOpacity(this.style('fill-opacity').value);c.fillStyle=f.value;}if(this.style('stroke').isUrlDefinition()){var e=this.style('stroke').getFillStyleDefinition(this,this.style('stroke-opacity'));if(e!=null)c.strokeStyle=e;}else if(this.style('stroke').hasValue()){var h=this.style('stroke');if(h.value=='currentColor')h.value=this.style('color').value;c.strokeStyle=(h.value=='none'?'rgba(0,0,0,0)':h.value);}if(this.style('stroke-opacity').hasValue()){var h=new d.Property('stroke',c.strokeStyle);h=h.addOpacity(this.style('stroke-opacity').value);c.strokeStyle=h.value;}if(this.style('stroke-width').hasValue()){var k=this.style('stroke-width').toPixels();c.lineWidth=k==0?0.001:k;}if(this.style('stroke-linecap').hasValue())c.lineCap=this.style('stroke-linecap').value;if(this.style('stroke-linejoin').hasValue())c.lineJoin=this.style('stroke-linejoin').value;if(this.style('stroke-miterlimit').hasValue())c.miterLimit=this.style('stroke-miterlimit').value;if(this.style('stroke-dasharray').hasValue()&&this.style('stroke-dasharray').value!='none'){var j=d.ToNumberArray(this.style('stroke-dasharray').value);if(typeof (c.setLineDash)!='undefined'){c.setLineDash(j);}else if(typeof (c.webkitLineDash)!='undefined'){c.webkitLineDash=j;}else if(typeof (c.mozDash)!='undefined'){c.mozDash=j;}var l=this.style('stroke-dashoffset').numValueOrDefault(1);if(typeof (c.lineDashOffset)!='undefined'){c.lineDashOffset=l;}else if(typeof (c.webkitLineDashOffset)!='undefined'){c.webkitLineDashOffset=l;}else if(typeof (c.mozDashOffset)!='undefined'){c.mozDashOffset=l;}}if(typeof (c.font)!='undefined'){c.font=d.Font.CreateFont(this.style('font-style').value,this.style('font-variant').value,this.style('font-weight').value,this.style('font-size').hasValue()?this.style('font-size').toPixels()+'px':'',this.style('font-family').value).toString();}if(this.attribute('transform').hasValue()){var q=new d.Transform(this.attribute('transform').value);q.apply(c);}if(this.style('clip-path').hasValue()){var n=this.style('clip-path').getDefinition();if(n!=null)n.apply(c);}if(this.style('opacity').hasValue()){c.globalAlpha=this.style('opacity').numValue();}};};d.Element.RenderedElementBase.prototype=new d.Element.ElementBase;d.Element.PathElementBase=function(k){this.base=d.Element.RenderedElementBase;this.base(k);this.path=function(c){if(c!=null)c.beginPath();return new d.BoundingBox();};this.renderChildren=function(c){this.path(c);d.Mouse.checkPath(this,c);if(c.fillStyle!=''){if(this.attribute('fill-rule').valueOrDefault('inherit')!='inherit'){c.fill(this.attribute('fill-rule').value);}else{c.fill();}}if(c.strokeStyle!='')c.stroke();var e=this.getMarkers();if(e!=null){if(this.style('marker-start').isUrlDefinition()){var f=this.style('marker-start').getDefinition();f.render(c,e[0][0],e[0][1]);}if(this.style('marker-mid').isUrlDefinition()){var f=this.style('marker-mid').getDefinition();for(var h=1;h<e.length-1;h++){f.render(c,e[h][0],e[h][1]);}}if(this.style('marker-end').isUrlDefinition()){var f=this.style('marker-end').getDefinition();f.render(c,e[e.length-1][0],e[e.length-1][1]);}}};this.getBoundingBox=function(){return this.path();};this.getMarkers=function(){return null;};};d.Element.PathElementBase.prototype=new d.Element.RenderedElementBase;d.Element.svg=function(n){this.base=d.Element.RenderedElementBase;this.base(n);this.baseClearContext=this.clearContext;this.clearContext=function(c){this.baseClearContext(c);d.ViewPort.RemoveCurrent();};this.baseSetContext=this.setContext;this.setContext=function(c){c.strokeStyle='rgba(0,0,0,0)';c.lineCap='butt';c.lineJoin='miter';c.miterLimit=4;if(typeof (c.font)!='undefined'&&typeof (window.getComputedStyle)!='undefined'){c.font=window.getComputedStyle(c.canvas).getPropertyValue('font');}this.baseSetContext(c);if(!this.attribute('x').hasValue())this.attribute('x',true).value=0;if(!this.attribute('y').hasValue())this.attribute('y',true).value=0;c.translate(this.attribute('x').toPixels('x'),this.attribute('y').toPixels('y'));var e=d.ViewPort.width(),f=d.ViewPort.height();if(!this.attribute('width').hasValue())this.attribute('width',true).value='100%';if(!this.attribute('height').hasValue())this.attribute('height',true).value='100%';if(typeof (this.root)=='undefined'){e=this.attribute('width').toPixels('x');f=this.attribute('height').toPixels('y');var h=0,k=0;if(this.attribute('refX').hasValue()&&this.attribute('refY').hasValue()){h=-this.attribute('refX').toPixels('x');k=-this.attribute('refY').toPixels('y');}if(this.attribute('overflow').valueOrDefault('hidden')!='visible'){c.beginPath();c.moveTo(h,k);c.lineTo(e,k);c.lineTo(e,f);c.lineTo(h,f);c.closePath();c.clip();}}d.ViewPort.SetCurrent(e,f);if(this.attribute('viewBox').hasValue()){var j=d.ToNumberArray(this.attribute('viewBox').value),l=j[0],q=j[1];e=j[2];f=j[3];d.AspectRatio(c,this.attribute('preserveAspectRatio').value,d.ViewPort.width(),e,d.ViewPort.height(),f,l,q,this.attribute('refX').value,this.attribute('refY').value);d.ViewPort.RemoveCurrent();d.ViewPort.SetCurrent(j[2],j[3]);}};};d.Element.svg.prototype=new d.Element.RenderedElementBase;d.Element.rect=function(q){this.base=d.Element.PathElementBase;this.base(q);this.path=function(c){var e=this.attribute('x').toPixels('x'),f=this.attribute('y').toPixels('y'),h=this.attribute('width').toPixels('x'),k=this.attribute('height').toPixels('y'),j=this.attribute('rx').toPixels('x'),l=this.attribute('ry').toPixels('y');if(this.attribute('rx').hasValue()&&!this.attribute('ry').hasValue())l=j;if(this.attribute('ry').hasValue()&&!this.attribute('rx').hasValue())j=l;j=Math.min(j,h/2.0);l=Math.min(l,k/2.0);if(c!=null){c.beginPath();c.moveTo(e+j,f);c.lineTo(e+h-j,f);c.quadraticCurveTo(e+h,f,e+h,f+l);c.lineTo(e+h,f+k-l);c.quadraticCurveTo(e+h,f+k,e+h-j,f+k);c.lineTo(e+j,f+k);c.quadraticCurveTo(e,f+k,e,f+k-l);c.lineTo(e,f+l);c.quadraticCurveTo(e,f,e+j,f);c.closePath();}return new d.BoundingBox(e,f,e+h,f+k);};};d.Element.rect.prototype=new d.Element.PathElementBase;d.Element.circle=function(k){this.base=d.Element.PathElementBase;this.base(k);this.path=function(c){var e=this.attribute('cx').toPixels('x'),f=this.attribute('cy').toPixels('y'),h=this.attribute('r').toPixels();if(c!=null){c.beginPath();c.arc(e,f,h,0,Math.PI*2,true);c.closePath();}return new d.BoundingBox(e-h,f-h,e+h,f+h);};};d.Element.circle.prototype=new d.Element.PathElementBase;d.Element.ellipse=function(l){this.base=d.Element.PathElementBase;this.base(l);this.path=function(c){var e=4*((Math.sqrt(2)-1)/3),f=this.attribute('rx').toPixels('x'),h=this.attribute('ry').toPixels('y'),k=this.attribute('cx').toPixels('x'),j=this.attribute('cy').toPixels('y');if(c!=null){c.beginPath();c.moveTo(k,j-h);c.bezierCurveTo(k+(e*f),j-h,k+f,j-(e*h),k+f,j);c.bezierCurveTo(k+f,j+(e*h),k+(e*f),j+h,k,j+h);c.bezierCurveTo(k-(e*f),j+h,k-f,j+(e*h),k-f,j);c.bezierCurveTo(k-f,j-(e*h),k-(e*f),j-h,k,j-h);c.closePath();}return new d.BoundingBox(k-f,j-h,k+f,j+h);};};d.Element.ellipse.prototype=new d.Element.PathElementBase;d.Element.line=function(f){this.base=d.Element.PathElementBase;this.base(f);this.getPoints=function(){return [new d.Point(this.attribute('x1').toPixels('x'),this.attribute('y1').toPixels('y')),new d.Point(this.attribute('x2').toPixels('x'),this.attribute('y2').toPixels('y'))];};this.path=function(c){var e=this.getPoints();if(c!=null){c.beginPath();c.moveTo(e[0].x,e[0].y);c.lineTo(e[1].x,e[1].y);}return new d.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y);};this.getMarkers=function(){var c=this.getPoints(),e=c[0].angleTo(c[1]);return [[c[0],e],[c[1],e]];};};d.Element.line.prototype=new d.Element.PathElementBase;d.Element.polyline=function(h){this.base=d.Element.PathElementBase;this.base(h);this.points=d.CreatePath(this.attribute('points').value);this.path=function(c){var e=new d.BoundingBox(this.points[0].x,this.points[0].y);if(c!=null){c.beginPath();c.moveTo(this.points[0].x,this.points[0].y);}for(var f=1;f<this.points.length;f++){e.addPoint(this.points[f].x,this.points[f].y);if(c!=null)c.lineTo(this.points[f].x,this.points[f].y);}return e;};this.getMarkers=function(){var c=[];for(var e=0;e<this.points.length-1;e++){c.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);}c.push([this.points[this.points.length-1],c[c.length-1][1]]);return c;};};d.Element.polyline.prototype=new d.Element.PathElementBase;d.Element.polygon=function(f){this.base=d.Element.polyline;this.base(f);this.basePath=this.path;this.path=function(c){var e=this.basePath(c);if(c!=null){c.lineTo(this.points[0].x,this.points[0].y);c.closePath();}return e;};};d.Element.polygon.prototype=new d.Element.polyline;d.Element.path=function(S){this.base=d.Element.PathElementBase;this.base(S);var C=this.attribute('d').value;C=C.replace(/,/gm,' ');C=C.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,'$1 $2');C=C.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,'$1 $2');C=C.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,'$1 $2');C=C.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,'$1 $2');C=C.replace(/([0-9])([+\-])/gm,'$1 $2');C=C.replace(/(\.[0-9]*)(\.)/gm,'$1 $2');C=C.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,'$1 $3 $4 ');C=d.compressSpaces(C);C=d.trim(C);this.PathParser=new (function(h){this.tokens=h.split(' ');this.reset=function(){this.i=-1;this.command='';this.previousCommand='';this.start=new d.Point(0,0);this.control=new d.Point(0,0);this.current=new d.Point(0,0);this.points=[];this.angles=[];};this.isEnd=function(){return this.i>=this.tokens.length-1;};this.isCommandOrEnd=function(){if(this.isEnd())return true;return this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null;};this.isRelativeCommand=function(){switch(this.command){case 'm':case 'l':case 'h':case 'v':case 'c':case 's':case 'q':case 't':case 'a':case 'z':return true;break;}return false;};this.getToken=function(){this.i++;return this.tokens[this.i];};this.getScalar=function(){return parseFloat(this.getToken());};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken();};this.getPoint=function(){var c=new d.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(c);};this.getAsControlPoint=function(){var c=this.getPoint();this.control=c;return c;};this.getAsCurrentPoint=function(){var c=this.getPoint();this.current=c;return c;};this.getReflectedControlPoint=function(){if(this.previousCommand.toLowerCase()!='c'&&this.previousCommand.toLowerCase()!='s'&&this.previousCommand.toLowerCase()!='q'&&this.previousCommand.toLowerCase()!='t'){return this.current;}var c=new d.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return c;};this.makeAbsolute=function(c){if(this.isRelativeCommand()){c.x+=this.current.x;c.y+=this.current.y;}return c;};this.addMarker=function(c,e,f){if(f!=null&&this.angles.length>0&&this.angles[this.angles.length-1]==null){this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(f);}this.addMarkerAngle(c,e==null?null:e.angleTo(c));};this.addMarkerAngle=function(c,e){this.points.push(c);this.angles.push(e);};this.getMarkerPoints=function(){return this.points;};this.getMarkerAngles=function(){for(var c=0;c<this.angles.length;c++){if(this.angles[c]==null){for(var e=c+1;e<this.angles.length;e++){if(this.angles[e]!=null){this.angles[c]=this.angles[e];break;}}}}return this.angles;};})(C);this.path=function(f){var h=this.PathParser;h.reset();var k=new d.BoundingBox();if(f!=null)f.beginPath();while(!h.isEnd()){h.nextCommand();switch(h.command){case 'M':case 'm':var j=h.getAsCurrentPoint();h.addMarker(j);k.addPoint(j.x,j.y);if(f!=null)f.moveTo(j.x,j.y);h.start=h.current;while(!h.isCommandOrEnd()){var j=h.getAsCurrentPoint();h.addMarker(j,h.start);k.addPoint(j.x,j.y);if(f!=null)f.lineTo(j.x,j.y);}break;case 'L':case 'l':while(!h.isCommandOrEnd()){var l=h.current,j=h.getAsCurrentPoint();h.addMarker(j,l);k.addPoint(j.x,j.y);if(f!=null)f.lineTo(j.x,j.y);}break;case 'H':case 'h':while(!h.isCommandOrEnd()){var q=new d.Point((h.isRelativeCommand()?h.current.x:0)+h.getScalar(),h.current.y);h.addMarker(q,h.current);h.current=q;k.addPoint(h.current.x,h.current.y);if(f!=null)f.lineTo(h.current.x,h.current.y);}break;case 'V':case 'v':while(!h.isCommandOrEnd()){var q=new d.Point(h.current.x,(h.isRelativeCommand()?h.current.y:0)+h.getScalar());h.addMarker(q,h.current);h.current=q;k.addPoint(h.current.x,h.current.y);if(f!=null)f.lineTo(h.current.x,h.current.y);}break;case 'C':case 'c':while(!h.isCommandOrEnd()){var n=h.current,u=h.getPoint(),s=h.getAsControlPoint(),o=h.getAsCurrentPoint();h.addMarker(o,s,u);k.addBezierCurve(n.x,n.y,u.x,u.y,s.x,s.y,o.x,o.y);if(f!=null)f.bezierCurveTo(u.x,u.y,s.x,s.y,o.x,o.y);}break;case 'S':case 's':while(!h.isCommandOrEnd()){var n=h.current,u=h.getReflectedControlPoint(),s=h.getAsControlPoint(),o=h.getAsCurrentPoint();h.addMarker(o,s,u);k.addBezierCurve(n.x,n.y,u.x,u.y,s.x,s.y,o.x,o.y);if(f!=null)f.bezierCurveTo(u.x,u.y,s.x,s.y,o.x,o.y);}break;case 'Q':case 'q':while(!h.isCommandOrEnd()){var n=h.current,s=h.getAsControlPoint(),o=h.getAsCurrentPoint();h.addMarker(o,s,s);k.addQuadraticCurve(n.x,n.y,s.x,s.y,o.x,o.y);if(f!=null)f.quadraticCurveTo(s.x,s.y,o.x,o.y);}break;case 'T':case 't':while(!h.isCommandOrEnd()){var n=h.current,s=h.getReflectedControlPoint();h.control=s;var o=h.getAsCurrentPoint();h.addMarker(o,s,s);k.addQuadraticCurve(n.x,n.y,s.x,s.y,o.x,o.y);if(f!=null)f.quadraticCurveTo(s.x,s.y,o.x,o.y);}break;case 'A':case 'a':while(!h.isCommandOrEnd()){var n=h.current,t=h.getScalar(),v=h.getScalar(),w=h.getScalar()*(Math.PI/180.0),A=h.getScalar(),B=h.getScalar(),o=h.getAsCurrentPoint(),z=new d.Point(Math.cos(w)*(n.x-o.x)/2.0+Math.sin(w)*(n.y-o.y)/2.0,-Math.sin(w)*(n.x-o.x)/2.0+Math.cos(w)*(n.y-o.y)/2.0),G=Math.pow(z.x,2)/Math.pow(t,2)+Math.pow(z.y,2)/Math.pow(v,2);if(G>1){t*=Math.sqrt(G);v*=Math.sqrt(G);}var E=(A==B?-1:1)*Math.sqrt(((Math.pow(t,2)*Math.pow(v,2))-(Math.pow(t,2)*Math.pow(z.y,2))-(Math.pow(v,2)*Math.pow(z.x,2)))/(Math.pow(t,2)*Math.pow(z.y,2)+Math.pow(v,2)*Math.pow(z.x,2)));if(isNaN(E))E=0;var D=new d.Point(E*t*z.y/v,E*-v*z.x/t),F=new d.Point((n.x+o.x)/2.0+Math.cos(w)*D.x-Math.sin(w)*D.y,(n.y+o.y)/2.0+Math.sin(w)*D.x+Math.cos(w)*D.y),I=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2));},H=function(c,e){return (c[0]*e[0]+c[1]*e[1])/(I(c)*I(e));},J=function(c,e){return (c[0]*e[1]<c[1]*e[0]?-1:1)*Math.acos(H(c,e));},M=J([1,0],[(z.x-D.x)/t,(z.y-D.y)/v]),N=[(z.x-D.x)/t,(z.y-D.y)/v],P=[(-z.x-D.x)/t,(-z.y-D.y)/v],L=J(N,P);if(H(N,P)<=-1)L=Math.PI;if(H(N,P)>=1)L=0;var O=1-B?1.0:-1.0,K=M+O*(L/2.0),T=new d.Point(F.x+t*Math.cos(K),F.y+v*Math.sin(K));h.addMarkerAngle(T,K-O*Math.PI/2);h.addMarkerAngle(o,K-O*Math.PI);k.addPoint(o.x,o.y);if(f!=null){var H=t>v?t:v,R=t>v?1:t/v,Q=t>v?v/t:1;f.translate(F.x,F.y);f.rotate(w);f.scale(R,Q);f.arc(0,0,H,M,M+L,1-B);f.scale(1/R,1/Q);f.rotate(-w);f.translate(-F.x,-F.y);}}break;case 'Z':case 'z':if(f!=null)f.closePath();h.current=h.start;}}return k;};this.getMarkers=function(){var c=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),f=[];for(var h=0;h<c.length;h++){f.push([c[h],e[h]]);}return f;};};d.Element.path.prototype=new d.Element.PathElementBase;d.Element.pattern=function(s){this.base=d.Element.ElementBase;this.base(s);this.createPattern=function(c,e){var f=this.attribute('width').toPixels('x',true),h=this.attribute('height').toPixels('y',true),k=new d.Element.svg();k.attributes['viewBox']=new d.Property('viewBox',this.attribute('viewBox').value);k.attributes['width']=new d.Property('width',f+'px');k.attributes['height']=new d.Property('height',h+'px');k.attributes['transform']=new d.Property('transform',this.attribute('patternTransform').value);k.children=this.children;var j=document.createElement('canvas');j.width=f;j.height=h;var l=j.getContext('2d');if(this.attribute('x').hasValue()&&this.attribute('y').hasValue()){l.translate(this.attribute('x').toPixels('x',true),this.attribute('y').toPixels('y',true));}for(var q=-1;q<=1;q++){for(var n=-1;n<=1;n++){l.save();l.translate(q*j.width,n*j.height);k.render(l);l.restore();}}var u=c.createPattern(j,'repeat');return u;};};d.Element.pattern.prototype=new d.Element.ElementBase;d.Element.marker=function(k){this.base=d.Element.ElementBase;this.base(k);this.baseRender=this.render;this.render=function(c,e,f){c.translate(e.x,e.y);if(this.attribute('orient').valueOrDefault('auto')=='auto')c.rotate(f);if(this.attribute('markerUnits').valueOrDefault('strokeWidth')=='strokeWidth')c.scale(c.lineWidth,c.lineWidth);c.save();var h=new d.Element.svg();h.attributes['viewBox']=new d.Property('viewBox',this.attribute('viewBox').value);h.attributes['refX']=new d.Property('refX',this.attribute('refX').value);h.attributes['refY']=new d.Property('refY',this.attribute('refY').value);h.attributes['width']=new d.Property('width',this.attribute('markerWidth').value);h.attributes['height']=new d.Property('height',this.attribute('markerHeight').value);h.attributes['fill']=new d.Property('fill',this.attribute('fill').valueOrDefault('black'));h.attributes['stroke']=new d.Property('stroke',this.attribute('stroke').valueOrDefault('none'));h.children=this.children;h.render(c);c.restore();if(this.attribute('markerUnits').valueOrDefault('strokeWidth')=='strokeWidth')c.scale(1/c.lineWidth,1/c.lineWidth);if(this.attribute('orient').valueOrDefault('auto')=='auto')c.rotate(-f);c.translate(-e.x,-e.y);};};d.Element.marker.prototype=new d.Element.ElementBase;d.Element.defs=function(e){this.base=d.Element.ElementBase;this.base(e);this.render=function(c){};};d.Element.defs.prototype=new d.Element.ElementBase;d.Element.GradientBase=function(A){this.base=d.Element.ElementBase;this.base(A);this.gradientUnits=this.attribute('gradientUnits').valueOrDefault('objectBoundingBox');this.stops=[];for(var B=0;B<this.children.length;B++){var z=this.children[B];if(z.type=='stop')this.stops.push(z);}this.getGradient=function(){};this.createGradient=function(f,h,k){var j=this;if(this.getHrefAttribute().hasValue()){j=this.getHrefAttribute().getDefinition();}var l=function(c){if(k.hasValue()){var e=new d.Property('color',c);return e.addOpacity(k.value).value;}return c;},q=this.getGradient(f,h);if(q==null)return l(j.stops[j.stops.length-1].color);for(var n=0;n<j.stops.length;n++){q.addColorStop(j.stops[n].offset,l(j.stops[n].color));}if(this.attribute('gradientTransform').hasValue()){var u=d.ViewPort.viewPorts[0],s=new d.Element.rect();s.attributes['x']=new d.Property('x',-d.MAX_VIRTUAL_PIXELS/3.0);s.attributes['y']=new d.Property('y',-d.MAX_VIRTUAL_PIXELS/3.0);s.attributes['width']=new d.Property('width',d.MAX_VIRTUAL_PIXELS);s.attributes['height']=new d.Property('height',d.MAX_VIRTUAL_PIXELS);var o=new d.Element.g();o.attributes['transform']=new d.Property('transform',this.attribute('gradientTransform').value);o.children=[s];var t=new d.Element.svg();t.attributes['x']=new d.Property('x',0);t.attributes['y']=new d.Property('y',0);t.attributes['width']=new d.Property('width',u.width);t.attributes['height']=new d.Property('height',u.height);t.children=[o];var v=document.createElement('canvas');v.width=u.width;v.height=u.height;var w=v.getContext('2d');w.fillStyle=q;t.render(w);return w.createPattern(v,'no-repeat');}return q;};};d.Element.GradientBase.prototype=new d.Element.ElementBase;d.Element.linearGradient=function(q){this.base=d.Element.GradientBase;this.base(q);this.getGradient=function(c,e){var f=this.gradientUnits=='objectBoundingBox'?e.getBoundingBox():null;if(!this.attribute('x1').hasValue()&&!this.attribute('y1').hasValue()&&!this.attribute('x2').hasValue()&&!this.attribute('y2').hasValue()){this.attribute('x1',true).value=0;this.attribute('y1',true).value=0;this.attribute('x2',true).value=1;this.attribute('y2',true).value=0;}var h=(this.gradientUnits=='objectBoundingBox'?f.x()+f.width()*this.attribute('x1').numValue():this.attribute('x1').toPixels('x')),k=(this.gradientUnits=='objectBoundingBox'?f.y()+f.height()*this.attribute('y1').numValue():this.attribute('y1').toPixels('y')),j=(this.gradientUnits=='objectBoundingBox'?f.x()+f.width()*this.attribute('x2').numValue():this.attribute('x2').toPixels('x')),l=(this.gradientUnits=='objectBoundingBox'?f.y()+f.height()*this.attribute('y2').numValue():this.attribute('y2').toPixels('y'));if(h==j&&k==l)return null;return c.createLinearGradient(h,k,j,l);};};d.Element.linearGradient.prototype=new d.Element.GradientBase;d.Element.radialGradient=function(n){this.base=d.Element.GradientBase;this.base(n);this.getGradient=function(c,e){var f=e.getBoundingBox();if(!this.attribute('cx').hasValue())this.attribute('cx',true).value='50%';if(!this.attribute('cy').hasValue())this.attribute('cy',true).value='50%';if(!this.attribute('r').hasValue())this.attribute('r',true).value='50%';var h=(this.gradientUnits=='objectBoundingBox'?f.x()+f.width()*this.attribute('cx').numValue():this.attribute('cx').toPixels('x')),k=(this.gradientUnits=='objectBoundingBox'?f.y()+f.height()*this.attribute('cy').numValue():this.attribute('cy').toPixels('y')),j=h,l=k;if(this.attribute('fx').hasValue()){j=(this.gradientUnits=='objectBoundingBox'?f.x()+f.width()*this.attribute('fx').numValue():this.attribute('fx').toPixels('x'));}if(this.attribute('fy').hasValue()){l=(this.gradientUnits=='objectBoundingBox'?f.y()+f.height()*this.attribute('fy').numValue():this.attribute('fy').toPixels('y'));}var q=(this.gradientUnits=='objectBoundingBox'?(f.width()+f.height())/2.0*this.attribute('r').numValue():this.attribute('r').toPixels());return c.createRadialGradient(j,l,0,h,k,q);};};d.Element.radialGradient.prototype=new d.Element.GradientBase;d.Element.stop=function(c){this.base=d.Element.ElementBase;this.base(c);this.offset=this.attribute('offset').numValue();if(this.offset<0)this.offset=0;if(this.offset>1)this.offset=1;var e=this.style('stop-color');if(this.style('stop-opacity').hasValue())e=e.addOpacity(this.style('stop-opacity').value);this.color=e.value;};d.Element.stop.prototype=new d.Element.ElementBase;d.Element.AnimateBase=function(k){this.base=d.Element.ElementBase;this.base(k);d.Animations.push(this);this.duration=0.0;this.begin=this.attribute('begin').toMilliseconds();this.maxDuration=this.begin+this.attribute('dur').toMilliseconds();this.getProperty=function(){var c=this.attribute('attributeType').value,e=this.attribute('attributeName').value;if(c=='CSS'){return this.parent.style(e,true);}return this.parent.attribute(e,true);};this.initialValue=null;this.initialUnits='';this.removed=false;this.calcValue=function(){return '';};this.update=function(c){if(this.initialValue==null){this.initialValue=this.getProperty().value;this.initialUnits=this.getProperty().getUnits();}if(this.duration>this.maxDuration){if(this.attribute('repeatCount').value=='indefinite'||this.attribute('repeatDur').value=='indefinite'){this.duration=0.0;}else if(this.attribute('fill').valueOrDefault('remove')=='remove'&&!this.removed){this.removed=true;this.getProperty().value=this.initialValue;return true;}else{return false;}}this.duration=this.duration+c;var e=false;if(this.begin<this.duration){var f=this.calcValue();if(this.attribute('type').hasValue()){var h=this.attribute('type').value;f=h+'('+f+')';}this.getProperty().value=f;e=true;}return e;};this.from=this.attribute('from');this.to=this.attribute('to');this.values=this.attribute('values');if(this.values.hasValue())this.values.value=this.values.value.split(';');this.progress=function(){var c={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=c.progress*(this.values.value.length-1),f=Math.floor(e),h=Math.ceil(e);c.from=new d.Property('from',parseFloat(this.values.value[f]));c.to=new d.Property('to',parseFloat(this.values.value[h]));c.progress=(e-f)/(h-f);}else{c.from=this.from;c.to=this.to;}return c;};};d.Element.AnimateBase.prototype=new d.Element.ElementBase;d.Element.animate=function(f){this.base=d.Element.AnimateBase;this.base(f);this.calcValue=function(){var c=this.progress(),e=c.from.numValue()+(c.to.numValue()-c.from.numValue())*c.progress;return e+this.initialUnits;};};d.Element.animate.prototype=new d.Element.AnimateBase;d.Element.animateColor=function(l){this.base=d.Element.AnimateBase;this.base(l);this.calcValue=function(){var c=this.progress(),e=new RGBColor(c.from.value),f=new RGBColor(c.to.value);if(e.ok&&f.ok){var h=e.r+(f.r-e.r)*c.progress,k=e.g+(f.g-e.g)*c.progress,j=e.b+(f.b-e.b)*c.progress;return 'rgb('+parseInt(h,10)+','+parseInt(k,10)+','+parseInt(j,10)+')';}return this.attribute('from').value;};};d.Element.animateColor.prototype=new d.Element.AnimateBase;d.Element.animateTransform=function(j){this.base=d.Element.AnimateBase;this.base(j);this.calcValue=function(){var c=this.progress(),e=d.ToNumberArray(c.from.value),f=d.ToNumberArray(c.to.value),h='';for(var k=0;k<e.length;k++){h+=e[k]+(f[k]-e[k])*c.progress+' ';}return h;};};d.Element.animateTransform.prototype=new d.Element.animate;d.Element.font=function(c){this.base=d.Element.ElementBase;this.base(c);this.horizAdvX=this.attribute('horiz-adv-x').numValue();this.isRTL=false;this.isArabic=false;this.fontFace=null;this.missingGlyph=null;this.glyphs=[];for(var e=0;e<this.children.length;e++){var f=this.children[e];if(f.type=='font-face'){this.fontFace=f;if(f.style('font-family').hasValue()){d.Definitions[f.style('font-family').value]=this;}}else if(f.type=='missing-glyph')this.missingGlyph=f;else if(f.type=='glyph'){if(f.arabicForm!=''){this.isRTL=true;this.isArabic=true;if(typeof (this.glyphs[f.unicode])=='undefined')this.glyphs[f.unicode]=[];this.glyphs[f.unicode][f.arabicForm]=f;}else{this.glyphs[f.unicode]=f;}}}};d.Element.font.prototype=new d.Element.ElementBase;d.Element.fontface=function(c){this.base=d.Element.ElementBase;this.base(c);this.ascent=this.attribute('ascent').value;this.descent=this.attribute('descent').value;this.unitsPerEm=this.attribute('units-per-em').numValue();};d.Element.fontface.prototype=new d.Element.ElementBase;d.Element.missingglyph=function(c){this.base=d.Element.path;this.base(c);this.horizAdvX=0;};d.Element.missingglyph.prototype=new d.Element.path;d.Element.glyph=function(c){this.base=d.Element.path;this.base(c);this.horizAdvX=this.attribute('horiz-adv-x').numValue();this.unicode=this.attribute('unicode').value;this.arabicForm=this.attribute('arabic-form').value;};d.Element.glyph.prototype=new d.Element.path;d.Element.text=function(q){this.captureTextNodes=true;this.base=d.Element.RenderedElementBase;this.base(q);this.baseSetContext=this.setContext;this.setContext=function(c){this.baseSetContext(c);var e=this.style('dominant-baseline').toTextBaseline();if(e==null)e=this.style('alignment-baseline').toTextBaseline();if(e!=null)c.textBaseline=e;};this.getBoundingBox=function(){var c=this.attribute('x').toPixels('x'),e=this.attribute('y').toPixels('y'),f=this.parent.style('font-size').numValueOrDefault(d.Font.Parse(d.ctx.font).fontSize);return new d.BoundingBox(c,e-f,c+Math.floor(f*2.0/3.0)*this.children[0].getText().length,e);};this.renderChildren=function(c){this.x=this.attribute('x').toPixels('x');this.y=this.attribute('y').toPixels('y');this.x+=this.getAnchorDelta(c,this,0);for(var e=0;e<this.children.length;e++){this.renderChild(c,this,e);}};this.getAnchorDelta=function(c,e,f){var h=this.style('text-anchor').valueOrDefault('start');if(h!='start'){var k=0;for(var j=f;j<e.children.length;j++){var l=e.children[j];if(j>f&&l.attribute('x').hasValue())break;k+=l.measureTextRecursive(c);}return -1*(h=='end'?k:k/2.0);}return 0;};this.renderChild=function(c,e,f){var h=e.children[f];if(h.attribute('x').hasValue()){h.x=h.attribute('x').toPixels('x')+this.getAnchorDelta(c,e,f);}else{if(this.attribute('dx').hasValue())this.x+=this.attribute('dx').toPixels('x');if(h.attribute('dx').hasValue())this.x+=h.attribute('dx').toPixels('x');h.x=this.x;}this.x=h.x+h.measureText(c);if(h.attribute('y').hasValue()){h.y=h.attribute('y').toPixels('y');}else{if(this.attribute('dy').hasValue())this.y+=this.attribute('dy').toPixels('y');if(h.attribute('dy').hasValue())this.y+=h.attribute('dy').toPixels('y');h.y=this.y;}this.y=h.y;h.render(c);for(var f=0;f<h.children.length;f++){this.renderChild(c,h,f);}};};d.Element.text.prototype=new d.Element.RenderedElementBase;d.Element.TextElementBase=function(s){this.base=d.Element.RenderedElementBase;this.base(s);this.getGlyph=function(c,e,f){var h=e[f],k=null;if(c.isArabic){var j='isolated';if((f==0||e[f-1]==' ')&&f<e.length-2&&e[f+1]!=' ')j='terminal';if(f>0&&e[f-1]!=' '&&f<e.length-2&&e[f+1]!=' ')j='medial';if(f>0&&e[f-1]!=' '&&(f==e.length-1||e[f+1]==' '))j='initial';if(typeof (c.glyphs[h])!='undefined'){k=c.glyphs[h][j];if(k==null&&c.glyphs[h].type=='glyph')k=c.glyphs[h];}}else{k=c.glyphs[h];}if(k==null)k=c.missingGlyph;return k;};this.renderChildren=function(c){var e=this.parent.style('font-family').getDefinition();if(e!=null){var f=this.parent.style('font-size').numValueOrDefault(d.Font.Parse(d.ctx.font).fontSize),h=this.parent.style('font-style').valueOrDefault(d.Font.Parse(d.ctx.font).fontStyle),k=this.getText();if(e.isRTL)k=k.split("").reverse().join("");var j=d.ToNumberArray(this.parent.attribute('dx').value);for(var l=0;l<k.length;l++){var q=this.getGlyph(e,k,l),n=f/e.fontFace.unitsPerEm;c.translate(this.x,this.y);c.scale(n,-n);var u=c.lineWidth;c.lineWidth=c.lineWidth*e.fontFace.unitsPerEm/f;if(h=='italic')c.transform(1,0,.4,1,0,0);q.render(c);if(h=='italic')c.transform(1,0,-.4,1,0,0);c.lineWidth=u;c.scale(1/n,-1/n);c.translate(-this.x,-this.y);this.x+=f*(q.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm;if(typeof (j[l])!='undefined'&&!isNaN(j[l])){this.x+=j[l];}}return ;}if(c.fillStyle!='')c.fillText(d.compressSpaces(this.getText()),this.x,this.y);if(c.strokeStyle!='')c.strokeText(d.compressSpaces(this.getText()),this.x,this.y);};this.getText=function(){};this.measureTextRecursive=function(c){var e=this.measureText(c);for(var f=0;f<this.children.length;f++){e+=this.children[f].measureTextRecursive(c);}return e;};this.measureText=function(c){var e=this.parent.style('font-family').getDefinition();if(e!=null){var f=this.parent.style('font-size').numValueOrDefault(d.Font.Parse(d.ctx.font).fontSize),h=0,k=this.getText();if(e.isRTL)k=k.split("").reverse().join("");var j=d.ToNumberArray(this.parent.attribute('dx').value);for(var l=0;l<k.length;l++){var q=this.getGlyph(e,k,l);h+=(q.horizAdvX||e.horizAdvX)*f/e.fontFace.unitsPerEm;if(typeof (j[l])!='undefined'&&!isNaN(j[l])){h+=j[l];}}return h;}var n=d.compressSpaces(this.getText());if(!c.measureText)return n.length*10;c.save();this.setContext(c);var u=c.measureText(n).width;c.restore();return u;};};d.Element.TextElementBase.prototype=new d.Element.RenderedElementBase;d.Element.tspan=function(c){this.captureTextNodes=true;this.base=d.Element.TextElementBase;this.base(c);this.text=c.nodeValue||c.text||'';this.getText=function(){return this.text;};};d.Element.tspan.prototype=new d.Element.TextElementBase;d.Element.tref=function(e){this.base=d.Element.TextElementBase;this.base(e);this.getText=function(){var c=this.getHrefAttribute().getDefinition();if(c!=null)return c.children[0].getText();};};d.Element.tref.prototype=new d.Element.TextElementBase;d.Element.a=function(h){this.base=d.Element.TextElementBase;this.base(h);this.hasText=true;for(var k=0;k<h.childNodes.length;k++){if(h.childNodes[k].nodeType!=3)this.hasText=false;}this.text=this.hasText?h.childNodes[0].nodeValue:'';this.getText=function(){return this.text;};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(c){if(this.hasText){this.baseRenderChildren(c);var e=new d.Property('fontSize',d.Font.Parse(d.ctx.font).fontSize);d.Mouse.checkBoundingBox(this,new d.BoundingBox(this.x,this.y-e.toPixels('y'),this.x+this.measureText(c),this.y));}else{var f=new d.Element.g();f.children=this.children;f.parent=this;f.render(c);}};this.onclick=function(){window.open(this.getHrefAttribute().value);};this.onmousemove=function(){d.ctx.canvas.style.cursor='pointer';};};d.Element.a.prototype=new d.Element.TextElementBase;d.Element.image=function(j){this.base=d.Element.RenderedElementBase;this.base(j);var l=this.getHrefAttribute().value,q=l.match(/\.svg$/);d.Images.push(this);this.loaded=false;if(!q){this.img=document.createElement('img');if(d.opts['useCORS']==true){this.img.crossOrigin='Anonymous';}var n=this;this.img.onload=function(){n.loaded=true;};this.img.onerror=function(){d.log('ERROR: image "'+l+'" not found');n.loaded=true;};this.img.src=l;}else{this.img=d.ajax(l);this.loaded=true;}this.renderChildren=function(c){var e=this.attribute('x').toPixels('x'),f=this.attribute('y').toPixels('y'),h=this.attribute('width').toPixels('x'),k=this.attribute('height').toPixels('y');if(h==0||k==0)return ;c.save();if(q){c.drawSvg(this.img,e,f,h,k);}else{c.translate(e,f);d.AspectRatio(c,this.attribute('preserveAspectRatio').value,h,this.img.width,k,this.img.height,0,0);c.drawImage(this.img,0,0);}c.restore();};this.getBoundingBox=function(){var c=this.attribute('x').toPixels('x'),e=this.attribute('y').toPixels('y'),f=this.attribute('width').toPixels('x'),h=this.attribute('height').toPixels('y');return new d.BoundingBox(c,e,c+f,e+h);};};d.Element.image.prototype=new d.Element.RenderedElementBase;d.Element.g=function(f){this.base=d.Element.RenderedElementBase;this.base(f);this.getBoundingBox=function(){var c=new d.BoundingBox();for(var e=0;e<this.children.length;e++){c.addBoundingBox(this.children[e].getBoundingBox());}return c;};};d.Element.g.prototype=new d.Element.RenderedElementBase;d.Element.symbol=function(e){this.base=d.Element.RenderedElementBase;this.base(e);this.render=function(c){};};d.Element.symbol.prototype=new d.Element.RenderedElementBase;d.Element.style=function(c){this.base=d.Element.ElementBase;this.base(c);var e='';for(var f=0;f<c.childNodes.length;f++){e+=c.childNodes[f].nodeValue;}e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,'');e=d.compressSpaces(e);var h=e.split('}');for(var f=0;f<h.length;f++){if(d.trim(h[f])!=''){var k=h[f].split('{'),j=k[0].split(','),l=k[1].split(';');for(var q=0;q<j.length;q++){var n=d.trim(j[q]);if(n!=''){var u={};for(var s=0;s<l.length;s++){var o=l[s].indexOf(':'),t=l[s].substr(0,o),v=l[s].substr(o+1,l[s].length-o);if(t!=null&&v!=null){u[d.trim(t)]=new d.Property(d.trim(t),d.trim(v));}}d.Styles[n]=u;if(n=='@font-face'){var w=u['font-family'].value.replace(/"/g,''),A=u['src'].value.split(',');for(var B=0;B<A.length;B++){if(A[B].indexOf('format("svg")')>0){var z=A[B].indexOf('url'),G=A[B].indexOf(')',z),E=A[B].substr(z+5,G-z-6),D=d.parseXml(d.ajax(E)),F=D.getElementsByTagName('font');for(var I=0;I<F.length;I++){var H=d.CreateElement(F[I]);d.Definitions[w]=H;}}}}}}}}};d.Element.style.prototype=new d.Element.ElementBase;d.Element.use=function(h){this.base=d.Element.RenderedElementBase;this.base(h);this.baseSetContext=this.setContext;this.setContext=function(c){this.baseSetContext(c);if(this.attribute('x').hasValue())c.translate(this.attribute('x').toPixels('x'),0);if(this.attribute('y').hasValue())c.translate(0,this.attribute('y').toPixels('y'));};var k=this.getHrefAttribute().getDefinition();this.path=function(c){if(k!=null)k.path(c);};this.getBoundingBox=function(){if(k!=null)return k.getBoundingBox();};this.renderChildren=function(c){if(k!=null){var e=k;if(k.type=='symbol'){e=new d.Element.svg();e.type='svg';e.attributes['viewBox']=new d.Property('viewBox',k.attribute('viewBox').value);e.attributes['preserveAspectRatio']=new d.Property('preserveAspectRatio',k.attribute('preserveAspectRatio').value);e.attributes['overflow']=new d.Property('overflow',k.attribute('overflow').value);e.children=k.children;}if(e.type=='svg'){if(this.attribute('width').hasValue())e.attributes['width']=new d.Property('width',this.attribute('width').value);if(this.attribute('height').hasValue())e.attributes['height']=new d.Property('height',this.attribute('height').value);}var f=e.parent;e.parent=null;e.render(c);e.parent=f;}};};d.Element.use.prototype=new d.Element.RenderedElementBase;d.Element.mask=function(v){this.base=d.Element.ElementBase;this.base(v);this.apply=function(c,e){var f=this.attribute('x').toPixels('x'),h=this.attribute('y').toPixels('y'),k=this.attribute('width').toPixels('x'),j=this.attribute('height').toPixels('y');if(k==0&&j==0){var l=new d.BoundingBox();for(var q=0;q<this.children.length;q++){l.addBoundingBox(this.children[q].getBoundingBox());}var f=Math.floor(l.x1),h=Math.floor(l.y1),k=Math.floor(l.width()),j=Math.floor(l.height());}var n=e.attribute('mask').value;e.attribute('mask').value='';var u=document.createElement('canvas');u.width=f+k;u.height=h+j;var s=u.getContext('2d');this.renderChildren(s);var o=document.createElement('canvas');o.width=f+k;o.height=h+j;var t=o.getContext('2d');e.render(t);t.globalCompositeOperation='destination-in';t.fillStyle=s.createPattern(u,'no-repeat');t.fillRect(0,0,f+k,h+j);c.fillStyle=t.createPattern(o,'no-repeat');c.fillRect(0,0,f+k,h+j);e.attribute('mask').value=n;};this.render=function(c){};};d.Element.mask.prototype=new d.Element.ElementBase;d.Element.clipPath=function(k){this.base=d.Element.ElementBase;this.base(k);this.apply=function(c){for(var e=0;e<this.children.length;e++){var f=this.children[e];if(typeof (f.path)!='undefined'){var h=null;if(f.attribute('transform').hasValue()){h=new d.Transform(f.attribute('transform').value);h.apply(c);}f.path(c);c.clip();if(h){h.unapply(c);}}}};this.render=function(c){};};d.Element.clipPath.prototype=new d.Element.ElementBase;d.Element.filter=function(w){this.base=d.Element.ElementBase;this.base(w);this.apply=function(c,e){var f=e.getBoundingBox(),h=Math.floor(f.x1),k=Math.floor(f.y1),j=Math.floor(f.width()),l=Math.floor(f.height()),q=e.style('filter').value;e.style('filter').value='';var n=0,u=0;for(var s=0;s<this.children.length;s++){var o=this.children[s].extraFilterDistance||0;n=Math.max(n,o);u=Math.max(u,o);}var t=document.createElement('canvas');t.width=j+2*n;t.height=l+2*u;var v=t.getContext('2d');v.translate(-h+n,-k+u);e.render(v);for(var s=0;s<this.children.length;s++){this.children[s].apply(v,0,0,j+2*n,l+2*u);}c.drawImage(t,0,0,j+2*n,l+2*u,h-n,k-u,j+2*n,l+2*u);e.style('filter',true).value=q;};this.render=function(c){};};d.Element.filter.prototype=new d.Element.ElementBase;d.Element.feMorphology=function(j){this.base=d.Element.ElementBase;this.base(j);this.apply=function(c,e,f,h,k){};};d.Element.feMorphology.prototype=new d.Element.ElementBase;d.Element.feComposite=function(j){this.base=d.Element.ElementBase;this.base(j);this.apply=function(c,e,f,h,k){};};d.Element.feComposite.prototype=new d.Element.ElementBase;d.Element.feColorMatrix=function(s){this.base=d.Element.ElementBase;this.base(s);var o=d.ToNumberArray(this.attribute('values').value);switch(this.attribute('type').valueOrDefault('matrix')){case 'saturate':var t=o[0];o=[0.213+0.787*t,0.715-0.715*t,0.072-0.072*t,0,0,0.213-0.213*t,0.715+0.285*t,0.072-0.072*t,0,0,0.213-0.213*t,0.715-0.715*t,0.072+0.928*t,0,0,0,0,0,1,0,0,0,0,0,1];break;case 'hueRotate':var v=o[0]*Math.PI/180.0,w=function(c,e,f){return c+Math.cos(v)*e+Math.sin(v)*f;};o=[w(0.213,0.787,-0.213),w(0.715,-0.715,-0.715),w(0.072,-0.072,0.928),0,0,w(0.213,-0.213,0.143),w(0.715,0.285,0.140),w(0.072,-0.072,-0.283),0,0,w(0.213,-0.213,-0.787),w(0.715,-0.715,0.715),w(0.072,0.928,0.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case 'luminanceToAlpha':o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0,1];break;}function A(c,e,f,h,k,j){return c[f*h*4+e*4+j];}function B(c,e,f,h,k,j,l){c[f*h*4+e*4+j]=l;}function z(c,e){var f=o[c];return f*(f<0?e-255:e);}this.apply=function(c,e,f,h,k){var j=c.getImageData(0,0,h,k);for(var f=0;f<k;f++){for(var e=0;e<h;e++){var l=A(j.data,e,f,h,k,0),q=A(j.data,e,f,h,k,1),n=A(j.data,e,f,h,k,2),u=A(j.data,e,f,h,k,3);B(j.data,e,f,h,k,0,z(0,l)+z(1,q)+z(2,n)+z(3,u)+z(4,1));B(j.data,e,f,h,k,1,z(5,l)+z(6,q)+z(7,n)+z(8,u)+z(9,1));B(j.data,e,f,h,k,2,z(10,l)+z(11,q)+z(12,n)+z(13,u)+z(14,1));B(j.data,e,f,h,k,3,z(15,l)+z(16,q)+z(17,n)+z(18,u)+z(19,1));}}c.clearRect(0,0,h,k);c.putImageData(j,0,0);};};d.Element.feColorMatrix.prototype=new d.Element.ElementBase;d.Element.feGaussianBlur=function(j){this.base=d.Element.ElementBase;this.base(j);this.blurRadius=Math.floor(this.attribute('stdDeviation').numValue());this.extraFilterDistance=this.blurRadius;this.apply=function(c,e,f,h,k){if(typeof (stackBlurCanvasRGBA)=='undefined'){d.log('ERROR: StackBlur.js must be included for blur to work');return ;}c.canvas.id=d.UniqueId();c.canvas.style.display='none';document.body.appendChild(c.canvas);stackBlurCanvasRGBA(c.canvas.id,e,f,h,k,this.blurRadius);document.body.removeChild(c.canvas);};};d.Element.feGaussianBlur.prototype=new d.Element.ElementBase;d.Element.title=function(c){};d.Element.title.prototype=new d.Element.ElementBase;d.Element.desc=function(c){};d.Element.desc.prototype=new d.Element.ElementBase;d.Element.MISSING=function(c){d.log('ERROR: Element \''+c.nodeName+'\' not yet implemented.');};d.Element.MISSING.prototype=new d.Element.ElementBase;d.CreateElement=function(c){var e=c.nodeName.replace(/^[^:]+:/,'');e=e.replace(/\-/g,'');var f=null;if(typeof (d.Element[e])!='undefined'){f=new d.Element[e](c);}else{f=new d.Element.MISSING(c);}f.type=c.nodeName;return f;};d.load=function(c,e){d.loadXml(c,d.ajax(e));};d.loadXml=function(c,e){d.loadXmlDoc(c,d.parseXml(e));};d.loadXmlDoc=function(j,l){d.init(j);var q=function(c){var e=j.canvas;while(e){c.x-=e.offsetLeft;c.y-=e.offsetTop;e=e.offsetParent;}if(window.scrollX)c.x+=window.scrollX;if(window.scrollY)c.y+=window.scrollY;return c;};if(d.opts['ignoreMouse']!=true){j.canvas.onclick=function(c){var e=q(new d.Point(c!=null?c.clientX:event.clientX,c!=null?c.clientY:event.clientY));d.Mouse.onclick(e.x,e.y);};j.canvas.onmousemove=function(c){var e=q(new d.Point(c!=null?c.clientX:event.clientX,c!=null?c.clientY:event.clientY));d.Mouse.onmousemove(e.x,e.y);};}var n=d.CreateElement(l.documentElement);n.root=true;var u=true,s=function(){d.ViewPort.Clear();if(j.canvas.parentNode)d.ViewPort.SetCurrent(j.canvas.parentNode.clientWidth,j.canvas.parentNode.clientHeight);if(d.opts['ignoreDimensions']!=true){if(n.style('width').hasValue()){j.canvas.width=n.style('width').toPixels('x');j.canvas.style.width=j.canvas.width+'px';}if(n.style('height').hasValue()){j.canvas.height=n.style('height').toPixels('y');j.canvas.style.height=j.canvas.height+'px';}}var c=j.canvas.clientWidth||j.canvas.width,e=j.canvas.clientHeight||j.canvas.height;if(d.opts['ignoreDimensions']==true&&n.style('width').hasValue()&&n.style('height').hasValue()){c=n.style('width').toPixels('x');e=n.style('height').toPixels('y');}d.ViewPort.SetCurrent(c,e);if(d.opts['offsetX']!=null)n.attribute('x',true).value=d.opts['offsetX'];if(d.opts['offsetY']!=null)n.attribute('y',true).value=d.opts['offsetY'];if(d.opts['scaleWidth']!=null&&d.opts['scaleHeight']!=null){var f=1,h=1,k=d.ToNumberArray(n.attribute('viewBox').value);if(n.attribute('width').hasValue())f=n.attribute('width').toPixels('x')/d.opts['scaleWidth'];else if(!isNaN(k[2]))f=k[2]/d.opts['scaleWidth'];if(n.attribute('height').hasValue())h=n.attribute('height').toPixels('y')/d.opts['scaleHeight'];else if(!isNaN(k[3]))h=k[3]/d.opts['scaleHeight'];n.attribute('width',true).value=d.opts['scaleWidth'];n.attribute('height',true).value=d.opts['scaleHeight'];n.attribute('viewBox',true).value='0 0 '+(c*f)+' '+(e*h);n.attribute('preserveAspectRatio',true).value='none';}if(d.opts['ignoreClear']!=true){j.clearRect(0,0,c,e);}n.render(j);if(u){u=false;if(typeof (d.opts['renderCallback'])=='function')d.opts['renderCallback'](l);}},o=true;if(d.ImagesLoaded()){o=false;s();}d.intervalID=setInterval(function(){var c=false;if(o&&d.ImagesLoaded()){o=false;c=true;}if(d.opts['ignoreMouse']!=true){c=c|d.Mouse.hasEvents();}if(d.opts['ignoreAnimation']!=true){for(var e=0;e<d.Animations.length;e++){c=c|d.Animations[e].update(1000/d.FRAMERATE);}}if(typeof (d.opts['forceRedraw'])=='function'){if(d.opts['forceRedraw']()==true)c=true;}if(c){s();d.Mouse.runEvents();}},1000/d.FRAMERATE);};d.stop=function(){if(d.intervalID){clearInterval(d.intervalID);}};d.Mouse=new (function(){this.events=[];this.hasEvents=function(){return this.events.length!=0;};this.onclick=function(e,f){this.events.push({type:'onclick',x:e,y:f,run:function(c){if(c.onclick)c.onclick();}});};this.onmousemove=function(e,f){this.events.push({type:'onmousemove',x:e,y:f,run:function(c){if(c.onmousemove)c.onmousemove();}});};this.eventElements=[];this.checkPath=function(c,e){for(var f=0;f<this.events.length;f++){var h=this.events[f];if(e.isPointInPath&&e.isPointInPath(h.x,h.y))this.eventElements[f]=c;}};this.checkBoundingBox=function(c,e){for(var f=0;f<this.events.length;f++){var h=this.events[f];if(e.isPointInBox(h.x,h.y))this.eventElements[f]=c;}};this.runEvents=function(){d.ctx.canvas.style.cursor='';for(var c=0;c<this.events.length;c++){var e=this.events[c],f=this.eventElements[c];while(f){e.run(f);f=f.parent;}}this.events=[];this.eventElements=[];};});return d;}})();if(typeof (CanvasRenderingContext2D)!='undefined'){CanvasRenderingContext2D.prototype.drawSvg=function(c,e,f,h,k){canvg(this.canvas,c,{ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,ignoreClear:true,offsetX:e,offsetY:f,scaleWidth:h,scaleHeight:k});};}var is={ie:navigator.appName=='Microsoft Internet Explorer',java:navigator.javaEnabled(),ns:navigator.appName=='Netscape',ua:navigator.userAgent.toLowerCase(),version:parseFloat(navigator.appVersion.substr(21))||parseFloat(navigator.appVersion),win:navigator.platform=='Win32'};is.mac=is.ua.indexOf('mac')>=0;if(is.ua.indexOf('opera')>=0){is.ie=is.ns=false;is.opera=true;}if(is.ua.indexOf('gecko')>=0){is.ie=is.ns=false;is.gecko=true;};
function RGBColor(C){this.ok=false;if(C.charAt(0)=='#'){C=C.substr(1,6);}C=C.replace(/ /g,'');C=C.toLowerCase();var c={aliceblue:'f0f8ff',antiquewhite:'faebd7',aqua:'00ffff',aquamarine:'7fffd4',azure:'f0ffff',beige:'f5f5dc',bisque:'ffe4c4',black:'000000',blanchedalmond:'ffebcd',blue:'0000ff',blueviolet:'8a2be2',brown:'a52a2a',burlywood:'deb887',cadetblue:'5f9ea0',chartreuse:'7fff00',chocolate:'d2691e',coral:'ff7f50',cornflowerblue:'6495ed',cornsilk:'fff8dc',crimson:'dc143c',cyan:'00ffff',darkblue:'00008b',darkcyan:'008b8b',darkgoldenrod:'b8860b',darkgray:'a9a9a9',darkgreen:'006400',darkkhaki:'bdb76b',darkmagenta:'8b008b',darkolivegreen:'556b2f',darkorange:'ff8c00',darkorchid:'9932cc',darkred:'8b0000',darksalmon:'e9967a',darkseagreen:'8fbc8f',darkslateblue:'483d8b',darkslategray:'2f4f4f',darkturquoise:'00ced1',darkviolet:'9400d3',deeppink:'ff1493',deepskyblue:'00bfff',dimgray:'696969',dodgerblue:'1e90ff',feldspar:'d19275',firebrick:'b22222',floralwhite:'fffaf0',forestgreen:'228b22',fuchsia:'ff00ff',gainsboro:'dcdcdc',ghostwhite:'f8f8ff',gold:'ffd700',goldenrod:'daa520',gray:'808080',green:'008000',greenyellow:'adff2f',honeydew:'f0fff0',hotpink:'ff69b4',indianred:'cd5c5c',indigo:'4b0082',ivory:'fffff0',khaki:'f0e68c',lavender:'e6e6fa',lavenderblush:'fff0f5',lawngreen:'7cfc00',lemonchiffon:'fffacd',lightblue:'add8e6',lightcoral:'f08080',lightcyan:'e0ffff',lightgoldenrodyellow:'fafad2',lightgrey:'d3d3d3',lightgreen:'90ee90',lightpink:'ffb6c1',lightsalmon:'ffa07a',lightseagreen:'20b2aa',lightskyblue:'87cefa',lightslateblue:'8470ff',lightslategray:'778899',lightsteelblue:'b0c4de',lightyellow:'ffffe0',lime:'00ff00',limegreen:'32cd32',linen:'faf0e6',magenta:'ff00ff',maroon:'800000',mediumaquamarine:'66cdaa',mediumblue:'0000cd',mediumorchid:'ba55d3',mediumpurple:'9370d8',mediumseagreen:'3cb371',mediumslateblue:'7b68ee',mediumspringgreen:'00fa9a',mediumturquoise:'48d1cc',mediumvioletred:'c71585',midnightblue:'191970',mintcream:'f5fffa',mistyrose:'ffe4e1',moccasin:'ffe4b5',navajowhite:'ffdead',navy:'000080',oldlace:'fdf5e6',olive:'808000',olivedrab:'6b8e23',orange:'ffa500',orangered:'ff4500',orchid:'da70d6',palegoldenrod:'eee8aa',palegreen:'98fb98',paleturquoise:'afeeee',palevioletred:'d87093',papayawhip:'ffefd5',peachpuff:'ffdab9',peru:'cd853f',pink:'ffc0cb',plum:'dda0dd',powderblue:'b0e0e6',purple:'800080',red:'ff0000',rosybrown:'bc8f8f',royalblue:'4169e1',saddlebrown:'8b4513',salmon:'fa8072',sandybrown:'f4a460',seagreen:'2e8b57',seashell:'fff5ee',sienna:'a0522d',silver:'c0c0c0',skyblue:'87ceeb',slateblue:'6a5acd',slategray:'708090',snow:'fffafa',springgreen:'00ff7f',steelblue:'4682b4',tan:'d2b48c',teal:'008080',thistle:'d8bfd8',tomato:'ff6347',turquoise:'40e0d0',violet:'ee82ee',violetred:'d02090',wheat:'f5deb3',white:'ffffff',whitesmoke:'f5f5f5',yellow:'ffff00',yellowgreen:'9acd32'};for(var n in c){if(C==n){C=c[n];}}var y=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:['rgb(123, 234, 45)','rgb(255,234,245)'],process:function(B){return [parseInt(B[1]),parseInt(B[2]),parseInt(B[3])];}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:['#00ff00','336699'],process:function(B){return [parseInt(B[1],16),parseInt(B[2],16),parseInt(B[3],16)];}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:['#fb0','f0f'],process:function(B){return [parseInt(B[1]+B[1],16),parseInt(B[2]+B[2],16),parseInt(B[3]+B[3],16)];}}];for(var f=0;f<y.length;f++){var e=y[f].re,W=y[f].process,d=e.exec(C);if(d){channels=W(d);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true;}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return 'rgb('+this.r+', '+this.g+', '+this.b+')';};this.toHex=function(){var B=this.r.toString(16),v=this.g.toString(16),E=this.b.toString(16);if(B.length==1)B='0'+B;if(v.length==1)v='0'+v;if(E.length==1)E='0'+E;return '#'+B+v+E;};this.getHelpXML=function(){var v=new Array();for(var E=0;E<y.length;E++){var S=y[E].example;for(var P=0;P<S.length;P++){v[v.length]=S[P];}}for(var Q in c){v[v.length]=Q;}var i=document.createElement('ul');i.setAttribute('id','rgbcolor-examples');for(var E=0;E<v.length;E++){try{var x=document.createElement('li'),k=new RGBColor(v[E]),U=document.createElement('div');U.style.cssText='margin: 3px; '+'border: 1px solid black; '+'background:'+k.toHex()+'; '+'color:'+k.toHex();U.appendChild(document.createTextNode('test'));var V=document.createTextNode(' '+v[E]+' -> '+k.toRGB()+' -> '+k.toHex());x.appendChild(U);x.appendChild(V);i.appendChild(x);}catch(B){}}return i;};};
var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function stackBlurImage(v,E,S,P){var Q=document.getElementById(v),i=Q.naturalWidth,x=Q.naturalHeight,k=document.getElementById(E);k.style.width=i+"px";k.style.height=x+"px";k.width=i;k.height=x;var U=k.getContext("2d");U.clearRect(0,0,i,x);U.drawImage(Q,0,0);if(isNaN(S)||S<1)return ;if(P)stackBlurCanvasRGBA(E,0,0,i,x,S);else stackBlurCanvasRGB(E,0,0,i,x,S);}function stackBlurCanvasRGBA(S,P,Q,i,x,k){if(isNaN(k)||k<1)return ;k|=0;var U=document.getElementById(S),V=U.getContext("2d"),C;try{try{C=V.getImageData(P,Q,i,x);}catch(E){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");C=V.getImageData(P,Q,i,x);}catch(v){alert("Cannot access local image");throw  new Error("unable to access local image data: "+v);return ;}}}catch(v){alert("Cannot access image");throw  new Error("unable to access image data: "+v);}var c=C.data,n,y,f,e,W,d,a0,o,q,p,z,J,K,H,I,F,t,u,s,A,M,N,j,R,L=k+k+1,b0=i<<2,T=i-1,l=x-1,D=k+1,m=D*(D+1)/2,G=new BlurStack(),h=G;for(f=1;f<L;f++){h=h.next=new BlurStack();if(f==D)var X=h;}h.next=G;var w=null,O=null;a0=d=0;var Y=mul_table[k],Z=shg_table[k];for(y=0;y<x;y++){F=t=u=s=o=q=p=z=0;J=D*(A=c[d]);K=D*(M=c[d+1]);H=D*(N=c[d+2]);I=D*(j=c[d+3]);o+=m*A;q+=m*M;p+=m*N;z+=m*j;h=G;for(f=0;f<D;f++){h.r=A;h.g=M;h.b=N;h.a=j;h=h.next;}for(f=1;f<D;f++){e=d+((T<f?T:f)<<2);o+=(h.r=(A=c[e]))*(R=D-f);q+=(h.g=(M=c[e+1]))*R;p+=(h.b=(N=c[e+2]))*R;z+=(h.a=(j=c[e+3]))*R;F+=A;t+=M;u+=N;s+=j;h=h.next;}w=G;O=X;for(n=0;n<i;n++){c[d+3]=j=(z*Y)>>Z;if(j!=0){j=255/j;c[d]=((o*Y)>>Z)*j;c[d+1]=((q*Y)>>Z)*j;c[d+2]=((p*Y)>>Z)*j;}else{c[d]=c[d+1]=c[d+2]=0;}o-=J;q-=K;p-=H;z-=I;J-=w.r;K-=w.g;H-=w.b;I-=w.a;e=(a0+((e=n+k+1)<T?e:T))<<2;F+=(w.r=c[e]);t+=(w.g=c[e+1]);u+=(w.b=c[e+2]);s+=(w.a=c[e+3]);o+=F;q+=t;p+=u;z+=s;w=w.next;J+=(A=O.r);K+=(M=O.g);H+=(N=O.b);I+=(j=O.a);F-=A;t-=M;u-=N;s-=j;O=O.next;d+=4;}a0+=i;}for(n=0;n<i;n++){t=u=s=F=q=p=z=o=0;d=n<<2;J=D*(A=c[d]);K=D*(M=c[d+1]);H=D*(N=c[d+2]);I=D*(j=c[d+3]);o+=m*A;q+=m*M;p+=m*N;z+=m*j;h=G;for(f=0;f<D;f++){h.r=A;h.g=M;h.b=N;h.a=j;h=h.next;}W=i;for(f=1;f<=k;f++){d=(W+n)<<2;o+=(h.r=(A=c[d]))*(R=D-f);q+=(h.g=(M=c[d+1]))*R;p+=(h.b=(N=c[d+2]))*R;z+=(h.a=(j=c[d+3]))*R;F+=A;t+=M;u+=N;s+=j;h=h.next;if(f<l){W+=i;}}d=n;w=G;O=X;for(y=0;y<x;y++){e=d<<2;c[e+3]=j=(z*Y)>>Z;if(j>0){j=255/j;c[e]=((o*Y)>>Z)*j;c[e+1]=((q*Y)>>Z)*j;c[e+2]=((p*Y)>>Z)*j;}else{c[e]=c[e+1]=c[e+2]=0;}o-=J;q-=K;p-=H;z-=I;J-=w.r;K-=w.g;H-=w.b;I-=w.a;e=(n+(((e=y+D)<l?e:l)*i))<<2;o+=(F+=(w.r=c[e]));q+=(t+=(w.g=c[e+1]));p+=(u+=(w.b=c[e+2]));z+=(s+=(w.a=c[e+3]));w=w.next;J+=(A=O.r);K+=(M=O.g);H+=(N=O.b);I+=(j=O.a);F-=A;t-=M;u-=N;s-=j;O=O.next;d+=i;}}V.putImageData(C,P,Q);}function stackBlurCanvasRGB(S,P,Q,i,x,k){if(isNaN(k)||k<1)return ;k|=0;var U=document.getElementById(S),V=U.getContext("2d"),C;try{try{C=V.getImageData(P,Q,i,x);}catch(E){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");C=V.getImageData(P,Q,i,x);}catch(v){alert("Cannot access local image");throw  new Error("unable to access local image data: "+v);return ;}}}catch(v){alert("Cannot access image");throw  new Error("unable to access image data: "+v);}var c=C.data,n,y,f,e,W,d,a0,o,q,p,z,J,K,H,I,F,t,u,s,A,M=k+k+1,N=i<<2,j=i-1,R=x-1,L=k+1,b0=L*(L+1)/2,T=new BlurStack(),l=T;for(f=1;f<M;f++){l=l.next=new BlurStack();if(f==L)var D=l;}l.next=T;var m=null,G=null;a0=d=0;var h=mul_table[k],X=shg_table[k];for(y=0;y<x;y++){H=I=F=o=q=p=0;z=L*(t=c[d]);J=L*(u=c[d+1]);K=L*(s=c[d+2]);o+=b0*t;q+=b0*u;p+=b0*s;l=T;for(f=0;f<L;f++){l.r=t;l.g=u;l.b=s;l=l.next;}for(f=1;f<L;f++){e=d+((j<f?j:f)<<2);o+=(l.r=(t=c[e]))*(A=L-f);q+=(l.g=(u=c[e+1]))*A;p+=(l.b=(s=c[e+2]))*A;H+=t;I+=u;F+=s;l=l.next;}m=T;G=D;for(n=0;n<i;n++){c[d]=(o*h)>>X;c[d+1]=(q*h)>>X;c[d+2]=(p*h)>>X;o-=z;q-=J;p-=K;z-=m.r;J-=m.g;K-=m.b;e=(a0+((e=n+k+1)<j?e:j))<<2;H+=(m.r=c[e]);I+=(m.g=c[e+1]);F+=(m.b=c[e+2]);o+=H;q+=I;p+=F;m=m.next;z+=(t=G.r);J+=(u=G.g);K+=(s=G.b);H-=t;I-=u;F-=s;G=G.next;d+=4;}a0+=i;}for(n=0;n<i;n++){I=F=H=q=p=o=0;d=n<<2;z=L*(t=c[d]);J=L*(u=c[d+1]);K=L*(s=c[d+2]);o+=b0*t;q+=b0*u;p+=b0*s;l=T;for(f=0;f<L;f++){l.r=t;l.g=u;l.b=s;l=l.next;}W=i;for(f=1;f<=k;f++){d=(W+n)<<2;o+=(l.r=(t=c[d]))*(A=L-f);q+=(l.g=(u=c[d+1]))*A;p+=(l.b=(s=c[d+2]))*A;H+=t;I+=u;F+=s;l=l.next;if(f<R){W+=i;}}d=n;m=T;G=D;for(y=0;y<x;y++){e=d<<2;c[e]=(o*h)>>X;c[e+1]=(q*h)>>X;c[e+2]=(p*h)>>X;o-=z;q-=J;p-=K;z-=m.r;J-=m.g;K-=m.b;e=(n+(((e=y+L)<R?e:R)*i))<<2;o+=(H+=(m.r=c[e]));q+=(I+=(m.g=c[e+1]));p+=(F+=(m.b=c[e+2]));m=m.next;z+=(t=G.r);J+=(u=G.g);K+=(s=G.b);H-=t;I-=u;F-=s;G=G.next;d+=i;}}V.putImageData(C,P,Q);}function BlurStack(){this.r=0;this.g=0;this.b=0;this.a=0;this.next=null;};